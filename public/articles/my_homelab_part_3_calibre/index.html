<!DOCTYPE html>
<html>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
      
      <a id="top"></a>
      <meta charset="utf-8">
      <meta name="viewport" 
          content="width=device-width, initial-scale=1.0">
      <title>My site</title>
      <link rel="stylesheet" href="/styles/style.css">  

      <link rel="stylesheet" href="/css/syntax.css">
      <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)']]                  
    }
  };
</script>

  </head>
  <body><div class="nav-div">
  <nav>
        <a href="http://localhost:1313/" class="">Home</a>
        <a href="http://localhost:1313/articles/" class="active">Articles</a>
        <a href="http://localhost:1313/paper-summary/" class="">Paper-Summaries</a>
        <a href="http://localhost:1313/tags/" class="">Tags</a>
        <a href="http://localhost:1313/poetry/" class="">Writings</a>
        <a href="http://localhost:1313/tangled_thoughts/" class="">Tangled-Thoughts</a>
        <a href="http://localhost:1313/media/" class="">Media</a>
        <a href="http://localhost:1313/links/" class="">Links</a>
        <a href="http://localhost:1313/about/" class="">About</a>
  </nav>
</div>
<div id="content">
<div class="article-content"> 
  <h1> My Homelab Part 3: Calibre </h1>
  <p class="pub-date">Published: January 19, 2024</p>
  
  <p>In my free time, I enjoy reading books. For a long time, I organized the books I read on physical paper notes. However, as the list grew longer and paper deteriorated over time, I realized it was impractical. To address this, I decided to switch to a digital organization strategy, and for that, I chose the software Calibre.</p>
<p>Calibre is a free and open-source e-book management program. It supports organizing existing e-books into virtual libraries, displaying and editing e-books, and even synchronizing them with different e-readers.</p>
<p><a href="https://github.com/janeczku/calibre-web">Calibre-Web</a> is a web app for Calibre that allows access to Calibre via the internet.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/ca92bc5421fc394fb5a55384fe696aea.png">
    <figcaption style="text-align:center">"An exemplary view of the Calibre-Web software.</figcaption>
</figure>


<p>In this short blog post, I&rsquo;ll guide you through the process of installing Calibre-Web.
If you are interested in how I set up my homeserver, you can read one of my previous blog posts.</p>
<h2 id="installation">Installation</h2>
<p>For the installation of Calibre-Web, I used Docker, specifically Docker Compose. If you&rsquo;re curious about why, you can check out my blog post &ldquo;My Homelab Part 1: Introduction,&rdquo; where I explain the advantages of docker.</p>
<p>In Docker, to start a container, you typically use a long command with configurations as arguments. This approach can be confusing and hard to reproduce.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/0d442bad34cd850c0ca7cba6f033393e.png">
    <figcaption style="text-align:center">Example of a docker command to run a container.</figcaption>
</figure>


<p>A better option is Docker Compose, where all the configurations are placed in a <code>compose.yaml</code> file, making it clearer and easier to reproduce.</p>
<p>In general the docker compose file uses <a href="https://en.wikipedia.org/wiki/YAML">YAML</a> as a file format, which is a human readable data language.
The Compose files uses some predefined keys that can be used to configure how docker should behave, to read more <a href="https://docs.docker.com/compose/">check this out</a>.</p>
<p>The Docker Compose file for Calibre I used is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;2.1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">  </span><span class="nt">calibre-web</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">lscr.io/linuxserver/calibre-web:latest</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">calibre-web</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">      </span>- <span class="l">PUID=1000</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">      </span>- <span class="l">PGID=1000</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">      </span>- <span class="l">TZ=Europe/Berlin</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">      </span>- <span class="l">/root/calibre/config:/config</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">      </span>- <span class="l">/mnt/externalDisk/calibre/libary:/books</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">      </span>- <span class="m">8083</span><span class="p">:</span><span class="m">8083</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">unless-stopped</span><span class="w">
</span></span></span></code></pre></div><p>This configuration file needs some explanation:</p>
<ul>
<li><code>image</code>  describes the container pulled from the internet i.e the software that you want to install. Images can be found on the <a href="https://hub.docker.com/">docker hub website</a>.</li>
<li><code>environment</code> specifies additional settings for the container. For instance:
<ul>
<li><code>TZ</code> specifies the timezone for the software</li>
<li><code>PUID/PGID</code> the id of the user and group under which the software will run.
<ul>
<li>to find out your <code>PUID/PGID</code> you can run the following command for user id:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl">id -u username
</span></span></code></pre></div>and for group id:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl">id -g username
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li><code>volumes</code> describe where data from the software is saved. The first path is the physical location on the computer, while the second is a virtual location inside the docker container, the paths are separated by <code>:</code>.</li>
<li><code>ports</code>  specify which ports are exposed to the docker container.</li>
<li><code>restart</code> instructs Docker on what to do if the container shuts down unexpectedly.</li>
</ul>
<p>Normally, you will be able to find a list of keys that you can set for the given image by looking at the docker hub page or on the maintainers page.
For instance you can check out <a href="https://docs.linuxserver.io/images/docker-calibre/#optional-run-configurations">linuxserver page on calibre</a>.</p>
<p>To install Calibre on your server, follow these steps:</p>
<ol>
<li>
<p>create a file titled <code>calibre-web-compose.yml</code> and copy the content of the above into the YAML file.</p>
</li>
<li>
<p>Edit the file to suit your needs, you should especially change the volumes, timezone, and PUID/PGID. Ensure the PUID and PGID match the owner of the volumes.</p>
</li>
<li>
<p>Move the file to your server. Save it in your home directory, and use <code>scp</code> to transfer it if needed.</p>
</li>
<li>
<p>Open a terminal at the file location and run::</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl">docker compose -f calibre-web-compose.yml up -d
</span></span></code></pre></div><p>This starts the container in the background:
The <code>-f</code> specifies the file name of the compose file
<code>-d</code> tells docker to start the container in the background without displaying the logs in the terminal.</p>
</li>
<li>
<p>After installation, check the container status by running:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl">docker ps -a
</span></span></code></pre></div></li>
<li>
<p>Access Calibre-Web at <code>http://&lt;IP_Of_Your_Server&gt;:Calibre_Port</code>, log in using the default credentials (Username: admin, Password: admin123).</p>
<p>

    <figure>
        <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/Screenshot%20from%202024-01-19%2017-59-03.png">
    </figure>
    

Should the default login data have changed, you should be able to find them on the <a href="https://docs.linuxserver.io/images/docker-calibre-web/#version-tags">image doc site</a> of calibre.</p>
</li>
<li>
<p>After login in you should get greeted by a window similar to the image below.</p>


    <figure>
        <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/Screenshot%20from%202024-01-19%2018-01-34.png">
    </figure>
    

</li>
</ol>
<p>In order to function properly Calibre-Web will need a virtual library, which is a databank that saves all the information about your books.
Unfortunately Calibre-Web, doesn&rsquo;t let you create new  libraries from scratch, instead it only works with already created existing libraries.
For that you can either:</p>
<ul>
<li>Download Calibre on your computer create an empty library and export it or</li>
<li>You can download an already created database, via the command:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl">weget sempervieo.de/metadata.db
</span></span></code></pre></div>If you do download this file make sure to make yourself the owner of the file and give you full permission on this file(see &ldquo;My Homelab Part 2: DietPi&rdquo;).</li>
</ul>
<p>After you have downloaded or created the file move the file into your books volume, that you have defined in your <code>compose</code> file. Following that, you should be able to select the books folder as database folder in the Calibre-Web application.</p>
<p>The last thing you should do, is enabling uploads of books via Calibre-Web and change your password. To do that navigate to</p>
<ul>
<li><code>Configuration -&gt; Edit Basic Confguration -&gt; Feature Configuration -&gt; Enable Uploads</code></li>
<li><code>admin -&gt; edit user</code></li>
</ul>
<h2 id="opds">OPDS</h2>
<p>The Open Publication Distribution System (OPDS) is an electronic catalog format for electronic publications. OPDS can be used on the server to enable clients, such as e-readers or programs with ODPS support, to discover and download e-books.</p>
<p>I use ODPS to download books to my e-reader (which uses Koreader software) or to my computer (which uses Calibre) whenever I want to read an e-book.</p>
<p>To configure ODPS for Koreader:</p>
<ol>
<li>
<p>Open the menu by tapping on the top of the screen</p>
</li>
<li>
<p>Navigate to the magnifying glass.</p>


    <figure>
        <img style="display: block; margin-left: auto; margin-right: auto; width:60%" src="/attachments/2024-01-20_11-54.png">
    </figure>
    

</li>
<li>
<p>Press the ODPD Catalog option, and press the + Button in the top left corner to add an ODPS Catalogue.</p>


    <figure>
        <img style="display: block; margin-left: auto; margin-right: auto; width:60%" src="/attachments/2024-01-20_11-57.png">
    </figure>
    

</li>
<li>
<p>Choose a catalogue name; the catalogue URL should be: <code>http://&lt;Server_IP&gt;:Calibre_Port/opds</code>. Enter the username and password defined in your Calibre-Web server.</p>
</li>
<li>
<p>To connect to your OPDS catalogue, press the newly added catalogue.</p>
</li>
</ol>
<p>As a last piece of advice,<a href="https://annas-archive.org/">Annas Archive</a> has an enormous library of e-books available for free download. However, please keep in mind that supporting authors is crucial for them to continue producing their awesome works.</p>
<hr>
<p>References:</p>
<ul>
<li><a href="https://github.com/janeczku/calibre-web/wiki">https://github.com/janeczku/calibre-web/wiki</a></li>
<li><a href="https://docs.linuxserver.io/images/docker-calibre-web/#version-tags">https://docs.linuxserver.io/images/docker-calibre-web/#version-tags</a></li>
<li><a href="https://en.wikipedia.org/wiki/Open_Publication_Distribution_System">https://en.wikipedia.org/wiki/Open_Publication_Distribution_System</a></li>
<li><a href="https://youtu.be/bucvyiwsnMc?si=SDn_PfIWOIXNgMoV">Calibre Web: Ebook Verwaltung leicht gemacht</a></li>
</ul>
 
</div>
<a href="#top" class="back-to-top-button">
  &#9650; 
</a>

    </div><div class="footer">
  Made with <a href="https://gohugo.io/">Hugo</a>, website licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>.
</div>
</body>
</html>
