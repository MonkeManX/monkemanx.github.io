<!DOCTYPE html>
<html>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
      
      <a id="top"></a>
      <meta charset="utf-8">
      <meta name="viewport" 
          content="width=device-width, initial-scale=1.0">
      <title>My site</title>
      <link rel="stylesheet" href="/styles/style.css">  

      <link rel="stylesheet" href="/css/syntax.css">
      <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)']]                  
    }
  };
</script>

  </head>
  <body><div class="nav-div">
  <nav>
        <a href="http://localhost:1313/" class="">Home</a>
        <a href="http://localhost:1313/articles/" class="active">Articles</a>
        <a href="http://localhost:1313/paper-summary/" class="">Paper-Summaries</a>
        <a href="http://localhost:1313/tags/" class="">Tags</a>
        <a href="http://localhost:1313/poetry/" class="">Writings</a>
        <a href="http://localhost:1313/tangled_thoughts/" class="">Tangled-Thoughts</a>
        <a href="http://localhost:1313/media/" class="">Media</a>
        <a href="http://localhost:1313/links/" class="">Links</a>
        <a href="http://localhost:1313/about/" class="">About</a>
  </nav>
</div>
<div id="content">
<div class="article-content"> 
  <h1> My Homelab Part 6: Syncthing </h1>
  <p class="pub-date">Published: January 20, 2024</p>
  
  <p>In this installment, I explore another valuable use case for my server - file synchronization between my various devices. This includes regular backups of the pictures taken on my phone, archiving important documents, and seamless access to notes across all devices for tasks like blogging, to-dos, projects, and university-related work. To accomplish this, I rely on the powerful capabilities of <a href="https://syncthing.net/">synthing</a> a continuous file synchronization program.</p>
<p>Syncthing operates by synchronizing files between two or more devices, akin to the functionality of OneDrive synchronization on Windows. However, instead of storing files on a cloud server, Syncthing saves them locally on my home server. The software comes equipped with a user-friendly WebUI that facilitates easy management of file synchronization and connected devices.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:60%" src="/attachments/2eb72858a7d12a81c0c1280e559dac46.png">
    <figcaption style="text-align:center">Example Syncthing Page.</figcaption>
</figure>


<h2 id="installation">Installation</h2>
<p>For the installation process, I utilize Docker Compose with the following configuration in the <code>synthing-compose.yml</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w">  </span><span class="nt">syncthing</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">syncthing/syncthing</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">syncthing</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l">my-syncthing</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">      </span>- <span class="l">PUID=1000</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">      </span>- <span class="l">PGID=1000</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">      </span>- <span class="l">/mnt/externalDisk/st-sync:/var/syncthing</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">      </span>- <span class="l">/mnt/externalDisk/media:/media</span><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">      </span>- <span class="m">8384</span><span class="p">:</span><span class="m">8384</span><span class="w"> </span><span class="c"># Web UI</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">      </span>- <span class="m">22000</span><span class="p">:</span><span class="m">22000</span><span class="l">/tcp</span><span class="w"> </span><span class="c"># TCP file transfers</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">      </span>- <span class="m">22000</span><span class="p">:</span><span class="m">22000</span><span class="l">/udp</span><span class="w"> </span><span class="c"># QUIC file transfers</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">      </span>- <span class="m">21027</span><span class="p">:</span><span class="m">21027</span><span class="l">/udp</span><span class="w"> </span><span class="c"># Receive local discovery broadcasts</span><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">unless-stopped</span><span class="w">
</span></span></span></code></pre></div><p>Remember to customize the Docker Compose file according to your preferences, particularly adjusting the <code>PUID</code> and <code>PGID</code> to match the owner ID of your Syncthing volume. To install and run the container, use the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl">docker compose -f synthing-compose.yml up -d
</span></span></code></pre></div><p>After installation, you can access the Syncthing WebUI using the URL: <code>http://&lt;IP_Of_Your_Server&gt;:Synthing_Port</code>.</p>
<h2 id="configuration-and-sychronization">Configuration and Sychronization</h2>
<p>For security, it&rsquo;s essential to set a password for the WebUI. Navigate to <code>Actions -&gt; Settings -&gt; GUI</code> and configure the GUI Authentication User and GUI Authentication Password fields.</p>
<h3 id="synchronize-phone-with-server">Synchronize Phone with Server</h3>
<p>To synchronize a folder between your server and phone, install the <a href="https://play.google.com/store/apps/details?id=com.nutomic.syncthingandroid&amp;hl=en&amp;gl=US">official Syncthing app</a>. Add your phone as a remote device on the server by clicking the <code>add remote Device</code> button.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:70%" src="/attachments/c1e52179d9d2652b71b31f7404ec3a38.png">
</figure>


<p>Insert your phone&rsquo;s device ID in the provided field (find it in the Syncthing app menu). Similarly, add your server as a device on your phone.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:50%" src="/attachments/722eb6143ff5c4f1b86a8b0b92681d0f.png">
</figure>


<p>You should also add your server as device to your phone, this works very similar to how you did it above.</p>
<p>Create a synchronization target by pressing the &ldquo;+&rdquo; button, select the folder, and share it with your server.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:50%" src="/attachments/38c70dd4cd4e4b8d37eaf3a806a9146b.png">
</figure>


<p>A popup on the server&rsquo;s Syncthing WebUI will appear, asking if you want to synchronize with the phone folder.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/b5e2a589822c5893e97c286f000c501e.png">
    <figcaption style="text-align:center"><a href="https://futurehousestore.co.uk/what-is-home-assistant-and-what-it-can-do">Source</a></figcaption>
</figure>


<p>That&rsquo;s it! Your phone pictures will now automatically upload to your server.</p>
<h3 id="synchronize-computer-with-server">Synchronize Computer with Server</h3>
<p>If you want to synchronize your Computer with your Server, you first need to install the <a href="https://syncthing.net/downloads/">synthing software</a> on your computer.</p>
<p>And after that, just like with the phone you need to add your computer as device to the server and vice versa.
Then you can again create a synchronization target.</p>
<h3 id="things-to-keep-in-mind">Things to keep in mind</h3>
<ul>
<li><strong>Synchronization Issues:</strong> If you are sharing a folder among devices with different operating systems and disk formats, enable the <code>ignoring Permissions</code> setting in the <code>Advanced</code> settings section of your synchronization target.</li>
</ul>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/8608b9ca84474054aad0baac8452da6a.png">
</figure>


<ul>
<li><strong>Battery Optimization on Phone:</strong> Disable battery optimization for the Syncthing app on your phone to prevent interference and ensure continuous synchronization.</li>
</ul>
<p>For additional information, refer to the <a href="https://docs.syncthing.net/">Syncthing documentation</a>.</p>
<hr>
<p>References:</p>
<ul>
<li><a href="https://syncthing.net/">https://syncthing.net/</a></li>
<li><a href="https://docs.syncthing.net/">https://docs.syncthing.net/</a></li>
</ul>
 
</div>
<a href="#top" class="back-to-top-button">
  &#9650; 
</a>

    </div><div class="footer">
  Made with <a href="https://gohugo.io/">Hugo</a>, website licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>.
</div>
</body>
</html>
