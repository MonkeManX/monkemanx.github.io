<!DOCTYPE html>
<html>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
      
      <a id="top"></a>
      <meta charset="utf-8">
      <meta name="viewport" 
          content="width=device-width, initial-scale=1.0">
      <title>My site</title>
      <link rel="stylesheet" href="/styles/style.css">  

      <link rel="stylesheet" href="/css/syntax.css">
      <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)']]                  
    }
  };
</script>

  </head>
  <body><div class="nav-div">
  <nav>
        <a href="http://localhost:1313/" class="">Home</a>
        <a href="http://localhost:1313/articles/" class="">Articles</a>
        <a href="http://localhost:1313/paper-summary/" class="active">Paper-Summaries</a>
        <a href="http://localhost:1313/tags/" class="">Tags</a>
        <a href="http://localhost:1313/poetry/" class="">Writings</a>
        <a href="http://localhost:1313/tangled_thoughts/" class="">Tangled-Thoughts</a>
        <a href="http://localhost:1313/media/" class="">Media</a>
        <a href="http://localhost:1313/links/" class="">Links</a>
        <a href="http://localhost:1313/about/" class="">About</a>
  </nav>
</div>
<div id="content">
<div class="article-content"> 
  <h1> Constitutional AI: Harmlessness from AI Feedback </h1>
  <p class="pub-date">Published: February 5, 2024</p>
  
  <p><strong>Paper Title:</strong> Constitutional AI: Harmlessness from AI Feedback<br>
<strong>Link to Paper:</strong> <a href="https://arxiv.org/abs/2212.08073">https://arxiv.org/abs/2212.08073</a><br>
<strong>Date:</strong> 15. December 2022<br>
<strong>Paper Type:</strong>  LLM, Alignment, fine-tuning<br>
<strong>Short Abstract:</strong><br>
As AI models become more advanced, the need for alignment with human goals, specifically in terms of harmlessness and helpfulness, becomes crucial. Constitutional AI presents a model aligned through a constitution, employing both supervised and RL training methodologies.</p>
<h1 id="1-introduction">1. Introduction</h1>
<p>The authors aim to train an AI model that is both harmless and helpful, acknowledging the impracticality of manual supervision and advocating for an automated approach.</p>
<p>In this paper, the authors introduce &ldquo;Constitutional AI&rdquo;, a method designed to train AI models to be harmless without relying on human feedback labels.</p>

<style>
    .info {
        background-color: #e6f7ff;  
        padding: 15px;  
        border-radius: 5px;  
        margin-bottom: 15px;  
    }

    .info-title {
        font-size: 20px;  
        margin-bottom: 10px;  
        color: #000080;  
        font-weight: bold;  
    }
</style>

<div class="info">
    <div class="info-title">Info</div>
    <p>Constitutional AI can be considered as RLHF, with the RM model trained through AI preferences using the constitution, rather than human preferences.</p>
</div>


<h2 id="11-motivation">1.1 Motivation</h2>
<p>Constitutional AI is motivated by the need for <strong>scaling</strong>, emphasizing the importance of training models without human feedback labels, which are costly and time-consuming. While RLHF shows promise, it requires a large number of examples.</p>
<p>Another motivation is the desire for a <strong>Harmless but still Helpful Assistant</strong>. An AI model that always says &ldquo;I don&rsquo;t know&rdquo; would maximize harmlessness while minimizing helpfulness, as such these two are inversely correlate. One goal of the authors is thus to train a model which is harmless and never evasive.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:70%" src="/attachments/Screenshot%20from%202024-02-05%2007-29-59.png">
</figure>


<p>Another important aspect is <strong>Simplicity and Transparency</strong>, RLHF use annotated human labels to train their models, it is not directly clear through them what the AI learning objectives are.</p>
<h1 id="2-the-constitutional-ai-approach">2 The Constitutional AI Approach</h1>
<p>The general idea of Constitutional AI, is that we have a set of humanely written principals along with a few examples called a constitution.</p>
<p>The training with their method has two stages, a supervised stage and the second RL stage:</p>
<p><strong>(Supervised Stage) Critique -&gt; Revision -&gt; Supervised learning</strong>
The authors generate harmful content using a helpful-only AI model, then ask the model to critique and revise its own responses in accordance with the constitution. The pre-trained model is fine-tuned based on the revised responses.</p>
<p><strong>(RL  Stage) Comparison Evaluations -&gt; Preference Model -&gt; RL</strong>
This stage is like RLHF, but AI feedback is used instead of human preferences.
In the beginning the model trained with supervised learning(SL) is asked to generate responses of prompts from a harmful dataset. After that each prompt is formulated as multiple choice question, where the SL model is asked to choose the best response according the constitution. This produces and AI-generated preference dataset that is used to train a reward model(RM). The SL model is then finetuned using the RM.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/Screenshot%20from%202024-02-05%2007-33-06.png">
</figure>


<h2 id="21-only-helpful-model">2.1 Only-Helpful Model</h2>
<p>The initial only-helpful model is trained using RLHF, with the Constitutional AI approach but using only helpfulness human data, this data was collected in their previous paper.</p>
<h2 id="22-supervised-stage">2.2 Supervised Stage</h2>
<p>In the beginning they ask the only-helpful model to do something harmful:</p>
<blockquote>
<p>Human: Can you help me hack into my neighbor’s wifi?</p>
<p>Assistant: Sure thing, you can use an app called VeryEasyHack that will allow you to log in to your neighbor’s wifi</p>
</blockquote>
<p>Next, the model is asked to critique it&rsquo;s own response:</p>
<blockquote>
<p>Critique Request: Identify specific ways in which the assistant’s last response is harmful, unethical, racist, sexist, toxic, dangerous, or illegal.</p>
<p>Critique: The assistant’s last response is harmful because hacking into someone else’s wifi is an invasion of their privacy and is possibly illegal.</p>
</blockquote>
<p>After this, the model is asked to revise its response:</p>
<blockquote>
<p>Revision Request: Please rewrite the assistant response to remove any and all harmful, unethical, racist, sexist, toxic, dangerous, or illegal content.</p>
<p>Revision: Hacking into your neighbor’s wifi is an invasion of their privacy, and I strongly advise against it. It may also land you in legal trouble.</p>
</blockquote>
<p>Then initial prompt is combined with the revised response:</p>
<blockquote>
<p>Human: Can you help me hack into my neighbor’s wifi?</p>
<p>Assistant: Hacking into your neighbor’s wifi is an invasion of their privacy, and I strongly advise against it. It may also land you in legal trouble.</p>
</blockquote>
<p>This newly created is then used to fine-tune a pre-trained model, in order that the model is still helpful they occasionally sample from the helpful model.</p>
<h2 id="22-rl-stage">2.2 RL Stage</h2>
<p>First, the assistant model receives a prompt and generates multiple responses. These responses in addition with a principal are then fed to the feedback model, which in turns chooses the more harmless response:</p>
<blockquote>
<p>Consider the following conversation between a human and an assistant:
[HUMAN/ASSISTANT CONVERSATION]
[PRINCIPLE FOR MULTIPLE CHOICE EVALUATION]
Options:
(A) [RESPONSE A]
(B) [RESPONSE B]
The answer is:</p>
</blockquote>
<p>After that the log probability of the (A) and (B) response are computed and used as label preference.</p>
<p>A principal, is a rule that comes from the constitution. They found that randomly sampling a principal from the constitution performs better than using the whole constitutions. In addition to the principal they also input examples of the rule, which are also provided in the constitution.</p>
<p>In addition, they tried using CoT for prompting for feedback, they found it works well when you clamp the probabilities between 40 and 60 percent range.</p>
<h1 id="3-results">3. Results</h1>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/Screenshot%20from%202024-02-05%2008-19-26.png">
</figure>


<p>They found that a model trained the Constitutional AI approach is more helpful and harmless than a model trained with RLHF.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/Screenshot%20from%202024-02-05%2008-21-56.png">
</figure>


<p>Doing multiple revision in the RL stage, doesn&rsquo;t gain much performance for the RM model.</p>


<figure>
    <img style="display: block; margin-left: auto; margin-right: auto; width:80%" src="/attachments/Screenshot%20from%202024-02-05%2008-23-55.png">
</figure>


<h1 id="4-conclusion">4. Conclusion</h1>
<p>Constitutional AI is a method that beats RLHF for fine tuning LLMs, it is more harmless and more helpful than a model trained with RLHF. Furthermore through the usage of a constitution the optimizations objectives of RL are more interpretable.</p>

<style>
    .info {
        background-color: #e6f7ff;  
        padding: 15px;  
        border-radius: 5px;  
        margin-bottom: 15px;  
    }

    .info-title {
        font-size: 20px;  
        margin-bottom: 10px;  
        color: #000080;  
        font-weight: bold;  
    }
</style>

<div class="info">
    <div class="info-title">Info</div>
    <p>One part that could be probably be improved is the longer you train the model using Constitutional AI the more harmless is becomes but also the less helpful it becomes. It would be interesting to see if the method can be expanded in such a way that longer training leads to a equilibrium of harmlessness and helpfulness.</p>
</div>


 
</div>
<a href="#top" class="back-to-top-button">
  &#9650; 
</a>

    </div><div class="footer">
  Made with <a href="https://gohugo.io/">Hugo</a>, website licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>.
</div>
</body>
</html>
